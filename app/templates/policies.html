{% extends "base.html" %}

{% block title %}정책 관리{% endblock %}

{% block content %}
<div class="policies-container">
    <div class="page-header">
        <h2>정책 관리</h2>
        <div class="actions">
            <button class="btn primary">정책 추가</button>
            <button class="btn">정책 분석</button>
        </div>
    </div>

    <div class="search-filters">
        <div class="search-bar">
            <input type="text" placeholder="정책 검색..." id="policySearch">
        </div>
        <div class="filters">
            <select id="deviceFilter">
                <option value="">전체 장비</option>
                {% for device in devices %}
                    <option value="{{ device.id }}">{{ device.name }}</option>
                {% endfor %}
            </select>
            <select id="statusFilter">
                <option value="">전체 상태</option>
                <option value="Y">활성화</option>
                <option value="N">비활성화</option>
            </select>
        </div>
    </div>

    <div class="policies-grid">
        <table class="data-table">
            <thead>
                <tr>
                    <th>순서</th>
                    <th>장비</th>
                    <th>규칙명</th>
                    <th>상태</th>
                    <th>동작</th>
                    <th>출발지</th>
                    <th>목적지</th>
                    <th>서비스</th>
                    <th>사용여부</th>
                    <th>마지막 사용</th>
                    <th>작업</th>
                </tr>
            </thead>
            <tbody id="policies-table-body">
                {% if policies %}
                    {% for policy in policies %}
                    <tr>
                        <td>{{ policy.seq }}</td>
                        <td>{{ policy.device.name }}</td>
                        <td>{{ policy.rule_name }}</td>
                        <td>
                            {% if policy.enable == 'Y' %}
                                <span class="status-badge success">활성화</span>
                            {% else %}
                                <span class="status-badge warning">비활성화</span>
                            {% endif %}
                        </td>
                        <td>{{ policy.action }}</td>
                        <td>{{ policy.source }}</td>
                        <td>{{ policy.destination }}</td>
                        <td>{{ policy.service }}</td>
                        <td>
                            {% if policy.usage_status == '사용' %}
                                <span class="status-badge success">사용</span>
                            {% else %}
                                <span class="status-badge warning">미사용</span>
                            {% endif %}
                        </td>
                        <td>{{ policy.last_hit_date or '-' }}</td>
                        <td class="actions">
                            <button class="btn small">상세</button>
                            <button class="btn small">수정</button>
                            <button class="btn small danger">삭제</button>
                        </td>
                    </tr>
                    {% endfor %}
                {% else %}
                    <tr>
                        <td colspan="11" class="empty-message">등록된 정책이 없습니다.</td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
        
        <div class="pagination-container">
            {% include 'devices/_pagination.html' %}
        </div>
    </div>
</div>

{% block page_js %}
<script src="{{ url_for('static', filename='js/pages/policies.js') }}" type="module"></script>
{% endblock %}

{% endblock %} 